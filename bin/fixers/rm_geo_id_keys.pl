#!/usr/bin/env perl 
use strict;
use warnings;
use Carp;
use Data::Dumper;
 
use Options;
use lib "$ENV{TRENDS_HOME}/lib";
use GEO::Series;

BEGIN: {
  Options::use(qw(d q v h fuse=i));
    Options::useDefaults(fuse => -1);
    Options::get();
    die Options::usage() if $options{h};
    $ENV{DEBUG} = 1 if $options{d};
}


sub main {
    my $stats={};
    while (my $gse=<DATA>) {
	chomp $gse;
	warn "$gse\n" unless $options{q};
	my $geo_id=(split('_', $gse, 2))[1];
	my $geo=GEO->factory($geo_id);
	delete $geo->{$gse};
	$geo->update;
	$stats->{n_updated}++;
    }
    warn Dumper($stats);
}

main(@ARGV);

__DATA__
dataset_GDS1012
dataset_GDS1020
dataset_GDS1022
dataset_GDS1023
dataset_GDS1028
dataset_GDS1036
dataset_GDS1048
dataset_GDS1050
dataset_GDS1051
dataset_GDS1059
dataset_GDS1062
dataset_GDS1063
dataset_GDS1064
dataset_GDS1065
dataset_GDS1067
dataset_GDS1074
dataset_GDS1078
dataset_GDS1085
dataset_GDS1088
dataset_GDS1094
dataset_GDS1095
dataset_GDS1096
dataset_GDS1112
dataset_GDS12
dataset_GDS1204
dataset_GDS1209
dataset_GDS1210
dataset_GDS1212
dataset_GDS1215
dataset_GDS1220
dataset_GDS1221
dataset_GDS1230
dataset_GDS1231
dataset_GDS1235
dataset_GDS1237
dataset_GDS1249
dataset_GDS1250
dataset_GDS1252
dataset_GDS1253
dataset_GDS1256
dataset_GDS1257
dataset_GDS1258
dataset_GDS1263
dataset_GDS1269
dataset_GDS1282
dataset_GDS1284
dataset_GDS1286
dataset_GDS1287
dataset_GDS1288
dataset_GDS1289
dataset_GDS1290
dataset_GDS1295
dataset_GDS1304
dataset_GDS1310
dataset_GDS1312
dataset_GDS1313
dataset_GDS1314
dataset_GDS1317
dataset_GDS1320
dataset_GDS1321
dataset_GDS1324
dataset_GDS1325
dataset_GDS1326
dataset_GDS1327
dataset_GDS1329
dataset_GDS1330
dataset_GDS1331
dataset_GDS1332
dataset_GDS1333
dataset_GDS1334
dataset_GDS1340
dataset_GDS1344
dataset_GDS1347
dataset_GDS1348
dataset_GDS1353
dataset_GDS1362
dataset_GDS1365
dataset_GDS1369
dataset_GDS1372
dataset_GDS1373
dataset_GDS1375
dataset_GDS1376
dataset_GDS1380
dataset_GDS1381
dataset_GDS1384
dataset_GDS1388
dataset_GDS1390
dataset_GDS1392
dataset_GDS1397
dataset_GDS1401
dataset_GDS1402
dataset_GDS1405
dataset_GDS1407
dataset_GDS1411
dataset_GDS1412
dataset_GDS1413
dataset_GDS1414
dataset_GDS1419
dataset_GDS1423
dataset_GDS1424
dataset_GDS1427
dataset_GDS1436
dataset_GDS1438
dataset_GDS1439
dataset_GDS1440
dataset_GDS1447
dataset_GDS1449
dataset_GDS145
dataset_GDS1453
dataset_GDS1476
dataset_GDS1477
dataset_GDS1478
dataset_GDS1479
dataset_GDS1480
dataset_GDS1481
dataset_GDS1495
dataset_GDS1496
dataset_GDS1497
dataset_GDS1498
dataset_GDS1499
dataset_GDS1503
dataset_GDS1504
dataset_GDS1505
dataset_GDS1510
dataset_GDS1520
dataset_GDS1523
dataset_GDS1530
dataset_GDS1542
dataset_GDS1543
dataset_GDS1548
dataset_GDS1549
dataset_GDS1553
dataset_GDS1557
dataset_GDS1559
dataset_GDS156
dataset_GDS1562
dataset_GDS1563
dataset_GDS1568
dataset_GDS157
dataset_GDS1579
dataset_GDS158
dataset_GDS1580
dataset_GDS1584
dataset_GDS1597
dataset_GDS160
dataset_GDS1604
dataset_GDS161
dataset_GDS1615
dataset_GDS1617
dataset_GDS1618
dataset_GDS162
dataset_GDS1627
dataset_GDS1630
dataset_GDS1637
dataset_GDS1645
dataset_GDS1646
dataset_GDS1650
dataset_GDS1663
dataset_GDS1664
dataset_GDS1665
dataset_GDS1667
dataset_GDS1672
dataset_GDS1673
dataset_GDS1676
dataset_GDS1679
dataset_GDS1681
dataset_GDS1684
dataset_GDS1685
dataset_GDS1688
dataset_GDS1696
dataset_GDS1697
dataset_GDS1699
dataset_GDS170
dataset_GDS1700
dataset_GDS171
dataset_GDS1712
dataset_GDS1713
dataset_GDS1714
dataset_GDS1726
dataset_GDS1730
dataset_GDS1732
dataset_GDS1733
dataset_GDS1735
dataset_GDS1736
dataset_GDS1746
dataset_GDS1750
dataset_GDS1753
dataset_GDS1758
dataset_GDS1760
dataset_GDS1761
dataset_GDS1768
dataset_GDS177
dataset_GDS1772
dataset_GDS1774
dataset_GDS1777
dataset_GDS1779
dataset_GDS1780
dataset_GDS1783
dataset_GDS1791
dataset_GDS1792
dataset_GDS1806
dataset_GDS1807
dataset_GDS181
dataset_GDS1812
dataset_GDS1813
dataset_GDS1815
dataset_GDS1816
dataset_GDS183
dataset_GDS1830
dataset_GDS1835
dataset_GDS1836
dataset_GDS1839
dataset_GDS1841
dataset_GDS1846
dataset_GDS1847
dataset_GDS1850
dataset_GDS1852
dataset_GDS1857
dataset_GDS1858
dataset_GDS1869
dataset_GDS1873
dataset_GDS1875
dataset_GDS1886
dataset_GDS1887
dataset_GDS1902
dataset_GDS1912
dataset_GDS1917
dataset_GDS1925
dataset_GDS1926
dataset_GDS1940
dataset_GDS1942
dataset_GDS1954
dataset_GDS1956
dataset_GDS1960
dataset_GDS1962
dataset_GDS1965
dataset_GDS1968
dataset_GDS1971
dataset_GDS1972
dataset_GDS1973
dataset_GDS1974
dataset_GDS1975
dataset_GDS1976
dataset_GDS1979
dataset_GDS198
dataset_GDS1989
dataset_GDS1993
dataset_GDS2007
dataset_GDS2008
dataset_GDS2009
dataset_GDS201
dataset_GDS2010
dataset_GDS2014
dataset_GDS2018
dataset_GDS2021
dataset_GDS2023
dataset_GDS2034
dataset_GDS2035
dataset_GDS2036
dataset_GDS2038
dataset_GDS2039
dataset_GDS2040
dataset_GDS2042
dataset_GDS2045
dataset_GDS2046
dataset_GDS2048
dataset_GDS2049
dataset_GDS2052
dataset_GDS2054
dataset_GDS2055
dataset_GDS2056
dataset_GDS2057
dataset_GDS2058
dataset_GDS2080
dataset_GDS2081
dataset_GDS2083
dataset_GDS2084
dataset_GDS2086
dataset_GDS2087
dataset_GDS2088
dataset_GDS2089
dataset_GDS2090
dataset_GDS2095
dataset_GDS2096
dataset_GDS2097
dataset_GDS2104
dataset_GDS2106
dataset_GDS2113
dataset_GDS2118
dataset_GDS2125
dataset_GDS2126
dataset_GDS214
dataset_GDS2142
dataset_GDS2143
dataset_GDS215
dataset_GDS2153
dataset_GDS2154
dataset_GDS2164
dataset_GDS2168
dataset_GDS2170
dataset_GDS2171
dataset_GDS2175
dataset_GDS2176
dataset_GDS2180
dataset_GDS2182
dataset_GDS2183
dataset_GDS2189
dataset_GDS2190
dataset_GDS2191
dataset_GDS2193
dataset_GDS2200
dataset_GDS2201
dataset_GDS2204
dataset_GDS2205
dataset_GDS2206
dataset_GDS2213
dataset_GDS2214
dataset_GDS2215
dataset_GDS2216
dataset_GDS222
dataset_GDS2221
dataset_GDS223
dataset_GDS2230
dataset_GDS2234
dataset_GDS2239
dataset_GDS2240
dataset_GDS2241
dataset_GDS2242
dataset_GDS2244
dataset_GDS2245
dataset_GDS2246
dataset_GDS2250
dataset_GDS2251
dataset_GDS2255
dataset_GDS2287
dataset_GDS2295
dataset_GDS2297
dataset_GDS2298
dataset_GDS2307
dataset_GDS2310
dataset_GDS232
dataset_GDS2321
dataset_GDS2323
dataset_GDS2324
dataset_GDS2332
dataset_GDS2333
dataset_GDS2339
dataset_GDS2341
dataset_GDS2342
dataset_GDS2352
dataset_GDS2356
dataset_GDS2358
dataset_GDS2362
dataset_GDS2366
dataset_GDS2367
dataset_GDS2368
dataset_GDS2369
dataset_GDS2373
dataset_GDS2374
dataset_GDS2378
dataset_GDS2381
dataset_GDS2382
dataset_GDS2384
dataset_GDS2395
dataset_GDS2396
dataset_GDS2397
dataset_GDS2414
dataset_GDS2415
dataset_GDS2416
dataset_GDS2417
dataset_GDS2418
dataset_GDS2419
dataset_GDS2422
dataset_GDS2423
dataset_GDS2426
dataset_GDS2428
dataset_GDS2429
dataset_GDS2430
dataset_GDS2431
dataset_GDS2432
dataset_GDS2444
dataset_GDS2445
dataset_GDS2446
dataset_GDS2447
dataset_GDS2448
dataset_GDS2452
dataset_GDS2453
dataset_GDS2470
dataset_GDS2471
dataset_GDS2478
dataset_GDS2484
dataset_GDS2486
dataset_GDS2489
dataset_GDS2490
dataset_GDS2491
dataset_GDS2493
dataset_GDS2494
dataset_GDS2495
dataset_GDS2499
dataset_GDS2501
dataset_GDS2513
dataset_GDS2516
dataset_GDS2518
dataset_GDS2519
dataset_GDS2520
dataset_GDS2526
dataset_GDS2528
dataset_GDS2529
dataset_GDS2530
dataset_GDS2534
dataset_GDS2535
dataset_GDS2536
dataset_GDS2545
dataset_GDS2546
dataset_GDS2547
dataset_GDS2548
dataset_GDS2563
dataset_GDS2565
dataset_GDS2573
dataset_GDS258
dataset_GDS2601
dataset_GDS2603
dataset_GDS2604
dataset_GDS2606
dataset_GDS2609
dataset_GDS261
dataset_GDS2611
dataset_GDS2613
dataset_GDS2615
dataset_GDS2617
dataset_GDS2618
dataset_GDS262
dataset_GDS2622
dataset_GDS2623
dataset_GDS2626
dataset_GDS2628
dataset_GDS2635
dataset_GDS264
dataset_GDS2642
dataset_GDS2643
dataset_GDS2649
dataset_GDS265
dataset_GDS2653
dataset_GDS2655
dataset_GDS2656
dataset_GDS2657
dataset_GDS266
dataset_GDS267
dataset_GDS2676
dataset_GDS268
dataset_GDS2682
dataset_GDS2695
dataset_GDS2696
dataset_GDS2697
dataset_GDS270
dataset_GDS2705
dataset_GDS2706
dataset_GDS2723
dataset_GDS2724
dataset_GDS2728
dataset_GDS2729
dataset_GDS2732
dataset_GDS2733
dataset_GDS2735
dataset_GDS2736
dataset_GDS2737
dataset_GDS2739
dataset_GDS274
dataset_GDS2740
dataset_GDS2744
dataset_GDS2745
dataset_GDS2749
dataset_GDS2750
dataset_GDS2754
dataset_GDS2755
dataset_GDS2756
dataset_GDS2758
dataset_GDS2759
dataset_GDS2760
dataset_GDS2761
dataset_GDS2763
dataset_GDS2767
dataset_GDS2770
dataset_GDS2771
dataset_GDS2772
dataset_GDS2777
dataset_GDS2778
dataset_GDS2779
dataset_GDS2780
dataset_GDS2781
dataset_GDS2782
dataset_GDS2785
dataset_GDS2787
dataset_GDS2788
dataset_GDS2789
dataset_GDS2790
dataset_GDS2791
dataset_GDS2794
dataset_GDS2795
dataset_GDS2808
dataset_GDS2810
dataset_GDS2819
dataset_GDS2821
dataset_GDS2822
dataset_GDS2824
dataset_GDS2827
dataset_GDS2831
dataset_GDS2832
dataset_GDS2833
dataset_GDS2834
dataset_GDS2835
dataset_GDS2838
dataset_GDS2842
dataset_GDS2847
dataset_GDS2852
dataset_GDS2853
dataset_GDS2855
dataset_GDS2856
dataset_GDS2858
dataset_GDS2860
dataset_GDS2861
dataset_GDS2864
dataset_GDS2865
dataset_GDS2866
dataset_GDS2867
dataset_GDS2868
dataset_GDS287
dataset_GDS288
dataset_GDS2880
dataset_GDS2881
dataset_GDS2883
dataset_GDS2887
dataset_GDS2889
dataset_GDS289
dataset_GDS2892
dataset_GDS2902
dataset_GDS2904
dataset_GDS2908
dataset_GDS2918
dataset_GDS2919
dataset_GDS2920
dataset_GDS2921
dataset_GDS2922
dataset_GDS2926
dataset_GDS2930
dataset_GDS2931
dataset_GDS2932
dataset_GDS2933
dataset_GDS2935
dataset_GDS2938
dataset_GDS2939
dataset_GDS2940
dataset_GDS2941
dataset_GDS2947
dataset_GDS2951
dataset_GDS2952
dataset_GDS2954
dataset_GDS2958
dataset_GDS2959
dataset_GDS2960
dataset_GDS2963
dataset_GDS2966
dataset_GDS2970
dataset_GDS2971
dataset_GDS2975
dataset_GDS2978
dataset_GDS2987
dataset_GDS2988
dataset_GDS2990
dataset_GDS3003
dataset_GDS3004
dataset_GDS3005
dataset_GDS3007
dataset_GDS3011
dataset_GDS3012
dataset_GDS3017
dataset_GDS3027
dataset_GDS3029
dataset_GDS3032
dataset_GDS3034
dataset_GDS3041
dataset_GDS3042
dataset_GDS3043
dataset_GDS3044
dataset_GDS3045
dataset_GDS3046
dataset_GDS3047
dataset_GDS3048
dataset_GDS3049
dataset_GDS3051
dataset_GDS3054
dataset_GDS3057
dataset_GDS3060
dataset_GDS3062
dataset_GDS3068
dataset_GDS3069
dataset_GDS3071
dataset_GDS3073
dataset_GDS3082
dataset_GDS3085
dataset_GDS3088
dataset_GDS3089
dataset_GDS3091
dataset_GDS3092
dataset_GDS3095
dataset_GDS3096
dataset_GDS3097
dataset_GDS3100
dataset_GDS3101
dataset_GDS3104
dataset_GDS3105
dataset_GDS3110
dataset_GDS3111
dataset_GDS3112
dataset_GDS3113
dataset_GDS3115
dataset_GDS3116
dataset_GDS3119
dataset_GDS3124
dataset_GDS3125
dataset_GDS3126
dataset_GDS3127
dataset_GDS3128
dataset_GDS3129
dataset_GDS3138
dataset_GDS3139
dataset_GDS3141
dataset_GDS3147
dataset_GDS3155
dataset_GDS3158
dataset_GDS3160
dataset_GDS3175
dataset_GDS3177
dataset_GDS3179
dataset_GDS3181
dataset_GDS3182
dataset_GDS3191
dataset_GDS3192
dataset_GDS3193
dataset_GDS3196
dataset_GDS3203
dataset_GDS3207
dataset_GDS3211
dataset_GDS3215
dataset_GDS3217
dataset_GDS3218
dataset_GDS3220
dataset_GDS3223
dataset_GDS3233
dataset_GDS3256
dataset_GDS3257
dataset_GDS3258
dataset_GDS3260
dataset_GDS3262
dataset_GDS3268
dataset_GDS3274
dataset_GDS3281
dataset_GDS3282
dataset_GDS3283
dataset_GDS3285
dataset_GDS3289
dataset_GDS3290
dataset_GDS3291
dataset_GDS3292
dataset_GDS3297
dataset_GDS3298
dataset_GDS3300
dataset_GDS3308
dataset_GDS3309
dataset_GDS3312
dataset_GDS3313
dataset_GDS3315
dataset_GDS3318
dataset_GDS3324
dataset_GDS3329
dataset_GDS3330
dataset_GDS3333
dataset_GDS3342
dataset_GDS3345
dataset_GDS3347
dataset_GDS3356
dataset_GDS3360
dataset_GDS3367
dataset_GDS337
dataset_GDS3383
dataset_GDS3384
dataset_GDS3388
dataset_GDS3393
dataset_GDS3399
dataset_GDS3401
dataset_GDS3402
dataset_GDS3413
dataset_GDS3416
dataset_GDS3417
dataset_GDS3423
dataset_GDS3424
dataset_GDS3428
dataset_GDS3429
dataset_GDS3432
dataset_GDS3433
dataset_GDS3439
dataset_GDS3459
dataset_GDS3463
dataset_GDS3467
dataset_GDS3469
dataset_GDS3470
dataset_GDS3471
dataset_GDS3472
dataset_GDS3474
dataset_GDS3475
dataset_GDS3481
dataset_GDS3482
dataset_GDS3483
dataset_GDS3484
dataset_GDS3487
dataset_GDS3489
dataset_GDS3492
dataset_GDS3493
dataset_GDS3494
dataset_GDS3495
dataset_GDS3496
dataset_GDS3497
dataset_GDS3498
dataset_GDS3499
dataset_GDS3500
dataset_GDS3501
dataset_GDS3510
dataset_GDS3511
dataset_GDS3513
dataset_GDS3514
dataset_GDS3516
dataset_GDS3517
dataset_GDS3518
dataset_GDS3523
dataset_GDS3524
dataset_GDS3525
dataset_GDS3531
dataset_GDS3532
dataset_GDS3534
dataset_GDS3537
dataset_GDS3539
dataset_GDS3553
dataset_GDS3554
dataset_GDS3555
dataset_GDS3556
dataset_GDS3557
dataset_GDS3558
dataset_GDS3559
dataset_GDS3560
dataset_GDS3561
dataset_GDS3567
dataset_GDS3568
dataset_GDS3570
dataset_GDS3571
dataset_GDS3573
dataset_GDS3576
dataset_GDS3578
dataset_GDS358
dataset_GDS3580
dataset_GDS3581
dataset_GDS359
dataset_GDS3592
dataset_GDS3595
dataset_GDS360
dataset_GDS3600
dataset_GDS3601
dataset_GDS3602
dataset_GDS3603
dataset_GDS3604
dataset_GDS3606
dataset_GDS3609
dataset_GDS3610
dataset_GDS3615
dataset_GDS3626
dataset_GDS3627
dataset_GDS3628
dataset_GDS3630
dataset_GDS3631
dataset_GDS3634
dataset_GDS3635
dataset_GDS3638
dataset_GDS3640
dataset_GDS3644
dataset_GDS3646
dataset_GDS3649
dataset_GDS3656
dataset_GDS3658
dataset_GDS3665
dataset_GDS3668
dataset_GDS3669
dataset_GDS367
dataset_GDS3676
dataset_GDS3678
dataset_GDS3679
dataset_GDS368
dataset_GDS3681
dataset_GDS3686
dataset_GDS3688
dataset_GDS369
dataset_GDS3690
dataset_GDS3691
dataset_GDS3694
dataset_GDS3696
dataset_GDS3697
dataset_GDS3698
dataset_GDS3704
dataset_GDS3705
dataset_GDS3706
dataset_GDS3709
dataset_GDS3710
dataset_GDS3711
dataset_GDS3715
dataset_GDS3716
dataset_GDS3717
dataset_GDS386
dataset_GDS390
dataset_GDS395
dataset_GDS400
dataset_GDS412
dataset_GDS420
dataset_GDS421
dataset_GDS422
dataset_GDS423
dataset_GDS424
dataset_GDS425
dataset_GDS426
dataset_GDS449
dataset_GDS470
dataset_GDS472
dataset_GDS473
dataset_GDS476
dataset_GDS477
dataset_GDS478
dataset_GDS479
dataset_GDS483
dataset_GDS484
dataset_GDS486
dataset_GDS493
dataset_GDS494
dataset_GDS495
dataset_GDS498
dataset_GDS499
dataset_GDS501
dataset_GDS502
dataset_GDS504
dataset_GDS505
dataset_GDS507
dataset_GDS511
dataset_GDS513
dataset_GDS525
dataset_GDS527
dataset_GDS528
dataset_GDS53
dataset_GDS531
dataset_GDS532
dataset_GDS533
dataset_GDS534
dataset_GDS535
dataset_GDS536
dataset_GDS552
dataset_GDS559
dataset_GDS560
dataset_GDS561
dataset_GDS562
dataset_GDS563
dataset_GDS564
dataset_GDS594
dataset_GDS596
dataset_GDS609
dataset_GDS610
dataset_GDS611
dataset_GDS612
dataset_GDS622
dataset_GDS623
dataset_GDS624
dataset_GDS625
dataset_GDS647
dataset_GDS649
dataset_GDS651
dataset_GDS670
dataset_GDS686
dataset_GDS687
dataset_GDS690
dataset_GDS705
dataset_GDS707
dataset_GDS708
dataset_GDS709
dataset_GDS711
dataset_GDS719
dataset_GDS720
dataset_GDS721
dataset_GDS722
dataset_GDS723
dataset_GDS724
dataset_GDS725
dataset_GDS731
dataset_GDS737
dataset_GDS738
dataset_GDS748
dataset_GDS751
dataset_GDS756
dataset_GDS761
dataset_GDS77
dataset_GDS776
dataset_GDS78
dataset_GDS781
dataset_GDS785
dataset_GDS786
dataset_GDS80
dataset_GDS806
dataset_GDS807
dataset_GDS810
dataset_GDS817
dataset_GDS820
dataset_GDS823
dataset_GDS825
dataset_GDS826
dataset_GDS829
dataset_GDS830
dataset_GDS831
dataset_GDS832
dataset_GDS833
dataset_GDS834
dataset_GDS838
dataset_GDS841
dataset_GDS843
dataset_GDS845
dataset_GDS846
dataset_GDS847
dataset_GDS848
dataset_GDS849
dataset_GDS85
dataset_GDS852
dataset_GDS854
dataset_GDS855
dataset_GDS858
dataset_GDS86
dataset_GDS860
dataset_GDS88
dataset_GDS881
dataset_GDS884
dataset_GDS885
dataset_GDS892
dataset_GDS893
dataset_GDS894
dataset_GDS901
dataset_GDS906
dataset_GDS909
dataset_GDS910
dataset_GDS911
dataset_GDS913
dataset_GDS915
dataset_GDS916
dataset_GDS917
dataset_GDS918
dataset_GDS940
dataset_GDS942
dataset_GDS943
dataset_GDS944
dataset_GDS945
dataset_GDS946
dataset_GDS961
dataset_GDS962
dataset_GDS963
dataset_GDS968
dataset_GDS969
dataset_GDS971
dataset_GDS987
dataset_GDS988
dataset_GDS989
dataset_GDS992
dataset_GDS999
